{"version":3,"sources":["store.js","pages/main/Main.jsx","pages/layout/Layout.jsx","Routes.jsx","App.jsx","index.js"],"names":["createContext","initialData","map","label","id","Consumer","Object","classCallCheck","this","uniqueId","isBusy","data","done","_this","Error","setTimeout","Main","_useState","useState","_useState2","slicedToArray","streamData","setStreamData","_useState3","value","_useState4","producers","setProducers","_useState5","_useState6","consumers","setConsumers","inputChange","index","newProducers","toConsumableArray","splice","useEffect","processor","setInterval","_stream","shift","findIndex","c","nextAvailableConsumer","consume","consumer","__consumers","_consumers","processStream","length","clearInterval","react_default","a","createElement","className","onClick","concat","p","key","onChange","e","target","onKeyPress","Layout","_ref","children","PrivateRoute","Component","component","rest","objectWithoutProperties","react_router","assign","render","props","withRouter","loginRedirect","to","Routes_PrivateRoute","exact","path","AppHistory","createBrowserHistory","store","setContext","src_store","Provider","history","src_Routes","document","getElementById"],"mappings":"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","file":"static/js/main.4bf637c0.chunk.js","sourcesContent":["import { createContext } from 'react';\n\n\n\nexport default createContext();\n","import uniqueId from \"lodash/uniqueId\";\nimport React, { useEffect, useState } from \"react\";\nimport \"./main.scss\";\n\nconst initialData = [\n  \"hello\",\n  \"world\",\n  \"javascript\",\n  \"typescirpt\",\n  \"random\",\n  \"data\",\n  \"another random\"\n].map((label, id) => ({ id, label }));\n\nclass Consumer {\n  constructor() {\n    this.id = uniqueId(\"consumer_\");\n    this.isBusy = false;\n    this.data = null;\n  }\n\n  consume(data, done) {\n    if (this.isBusy) throw new Error(\"Busy\");\n    this.isBusy = true;\n    this.data = data;\n    setTimeout(() => {\n      this.isBusy = false;\n      this.data = null;\n      done(this);\n    }, 1000);\n  }\n}\n\nexport default () => {\n  const [streamData, setStreamData] = useState(initialData);\n  const [producers, setProducers] = useState([\n    {\n      value: \"\"\n    }\n  ]);\n\n  const [consumers, setConsumers] = useState([new Consumer()]);\n\n  const addProducer = () => {\n    setProducers([...producers, { value: \"\" }]);\n  };\n\n  const addConsumer = () => {\n    setConsumers([...consumers, new Consumer()]);\n  };\n\n  const inputChange = (index, value) => {\n    const newProducers = [...producers];\n    newProducers.splice(index, 1, { value });\n    setProducers(newProducers);\n  };\n\n  const produce = (index, label) => {\n    setStreamData([...streamData, { id: streamData.length + 1, label }]);\n    inputChange(index, \"\");\n  };\n\n  const processStream = () => {\n    const _stream = [...streamData];\n    const data = _stream.shift();\n    const index = consumers.findIndex(c => !c.isBusy);\n\n    if (data && index > -1) {\n      const nextAvailableConsumer = consumers[index];\n      nextAvailableConsumer.consume(data, function done(consumer) {\n        const __consumers = [...consumers];\n        const id = __consumers.findIndex(c => c.id === consumer.id);\n        __consumers.splice(id, 1, nextAvailableConsumer);\n        setConsumers(__consumers);\n      });\n      const _consumers = [...consumers];\n      _consumers.splice(index, 1, nextAvailableConsumer);\n      setConsumers(_consumers);\n      setStreamData(_stream);\n    }\n  };\n\n  useEffect(\n    () => {\n      const processor = setInterval(() => {\n        processStream();\n        if (!streamData.length) clearInterval(processor);\n      }, 500);\n\n      return () => clearInterval(processor);\n    },\n    [streamData]\n  );\n\n  return (\n    <div className=\"stream-demo\">\n      <div className=\"producers\">\n        <button className=\"add\" onClick={addProducer}>\n          +\n        </button>\n        {producers.map((p, id) => (\n          <div key={id} className=\"producer\">\n            <span className=\"name\">{`P${id + 1}`}</span>\n            <input\n              value={p.value}\n              onChange={e => inputChange(id, e.target.value)}\n              onKeyPress={e => {\n                if (e.key === \"Enter\") {\n                  produce(id, e.target.value);\n                }\n              }}\n            />\n          </div>\n        ))}\n      </div>\n      <div className=\"storage\">\n        {streamData.map(data => (\n          <span key={data.id} className=\"data\">\n            {data.label}\n          </span>\n        ))}\n      </div>\n      <div className=\"consumers\">\n        <button className=\"add\" onClick={addConsumer}>\n          +\n        </button>\n        {consumers.map((c, id) => (\n          <div key={id} className=\"consumer\">\n            <span className={c.isBusy ? \"name busy\" : \"name\"}>\n              {c.isBusy && <i className=\"fas fa-cog fa-spin\" />}\n              {!c.isBusy && <i className=\"fas fa-cog\" />}\n            </span>\n            {c.data && <span className=\"data\">{c.data.label}</span>}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport default ({ children }) => {\n  return (\n    <div>\n      {children}\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Route, Switch, withRouter, Redirect } from \"react-router-dom\";\n\nimport { Main, Layout } from \"./pages\";\n\nconst isLoggedIn = () => true;\n\nconst PrivateRoute = ({ component: Component, ...rest }) => {\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        isLoggedIn() ? (\n          <Layout>\n            <Component {...props} />\n          </Layout>\n        ) : (\n          <Redirect\n            to={{ pathname: \"/login\", state: { from: props.location } }}\n          />\n        )\n      }\n    />\n  );\n};\n\nconst Routes = () => {\n  const loginRedirect = () =>\n    isLoggedIn() ? (\n      <Redirect to=\"/\" />\n    ) : (\n      <Route path=\"/login\" title=\"Stream Demo\" component={Main} />\n    );\n  return (\n    <Switch>\n      <PrivateRoute exact path=\"/\" component={Main} />\n      <Route exact path=\"/\" render={loginRedirect} />\n      <Route exact path=\"/login\" render={loginRedirect} />\n      <Redirect to=\"/\" />\n    </Switch>\n  );\n};\n\nexport default withRouter(Routes);\n","import React, { useState } from 'react';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from 'history';\n\nimport StoreContext from './store';\nimport Routes from './Routes';\n\nexport const AppHistory = createBrowserHistory();\n\nexport default () => {\n\n\tconst [store, setContext] = useState({});\n\treturn (\n\t\t<StoreContext.Provider value={{store, setContext}}>\n\t\t\t<Router history={AppHistory}>\n        <Routes/>\n      </Router>\n\t\t</StoreContext.Provider>\n\t);\n}\n","import React from 'react';\nimport { render } from 'react-dom';\n\nimport './index.scss';\nimport App from './App';\n\nrender(<App />, document.getElementById('root'));\n"],"sourceRoot":""}