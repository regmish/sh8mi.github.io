{"version":3,"sources":["pages/main/Main.jsx","store.js","pages/layout/Layout.jsx","Routes.jsx","App.jsx","index.js"],"names":["createContext","getRandom","input","result","i","random","push","charAt","Math","floor","length","join","initialData","id","uniqueId","label","time","Consumer","Object","classCallCheck","this","isBusy","data","done","_this","Error","setTimeout","Main","_useState","useState","_useState2","slicedToArray","streamData","setStreamData","_useState3","_useState4","consumers","setConsumers","useEffect","processor","setInterval","_stream","toConsumableArray","shift","index","findIndex","c","nextAvailableConsumer","consume","consumer","__consumers","splice","_consumers","processStream","clearInterval","react_default","a","createElement","className","onClick","randoms","concat","produce","map","key","Layout","_ref","children","PrivateRoute","Component","component","rest","objectWithoutProperties","react_router","assign","render","props","withRouter","loginRedirect","to","Routes_PrivateRoute","exact","path","AppHistory","createBrowserHistory","store","setContext","src_store","Provider","value","history","src_Routes","document","getElementById"],"mappings":"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","file":"static/js/main.c0f5470b.chunk.js","sourcesContent":["import { random, uniqueId } from \"lodash\";\nimport React, { useEffect, useState } from \"react\";\nimport \"./main.scss\";\n\nconst getRandom = () => {\n  const input =\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n  let result = [];\n  for (let i = 0; i < random(5, 12, false); i++) {\n    result.push(input.charAt(Math.floor(Math.random() * input.length)));\n  }\n\n  return result.join(\"\");\n};\n\nconst initialData = [];\nfor (let i = 0; i < 20; i++) {\n  initialData.push({\n    id: uniqueId(),\n    label: getRandom(),\n    time: random(100, 2000, false)\n  });\n}\nclass Consumer {\n  constructor() {\n    this.id = uniqueId(\"consumer_\");\n    this.isBusy = false;\n    this.data = null;\n  }\n\n  consume(data, done) {\n    if (this.isBusy) throw new Error(\"Busy\");\n    this.isBusy = true;\n    this.data = data;\n    setTimeout(() => {\n      this.isBusy = false;\n      this.data = null;\n      done(this);\n    }, data.time);\n  }\n}\n\nexport default () => {\n  const [streamData, setStreamData] = useState(initialData);\n\n  const [consumers, setConsumers] = useState([\n    new Consumer(),\n    new Consumer(),\n    new Consumer()\n  ]);\n\n  // const addProducer = () => {\n  //   setProducers([...producers, { value: \"\" }]);\n  // };\n\n  // const addConsumer = () => {\n  //   setConsumers([...consumers, new Consumer()]);\n  // };\n\n  // const inputChange = (index, value) => {\n  //   const newProducers = [...producers];\n  //   newProducers.splice(index, 1, { value });\n  //   setProducers(newProducers);\n  // };\n\n  const produce = () => {\n    if (streamData.length < 20) {\n      const randoms = [];\n      for (let i = 0; i < 20 - streamData.length; i++) {\n        randoms.push({\n          id: uniqueId(),\n          label: getRandom(),\n          time: random(100, 2000, false)\n        });\n      }\n      setStreamData([...streamData, ...randoms]);\n    }\n  };\n\n  const processStream = () => {\n    const _stream = [...streamData];\n    const data = _stream.shift();\n    const index = consumers.findIndex(c => !c.isBusy);\n\n    if (data && index > -1) {\n      const nextAvailableConsumer = consumers[index];\n      nextAvailableConsumer.consume(data, function done(consumer) {\n        const __consumers = [...consumers];\n        const id = __consumers.findIndex(c => c.id === consumer.id);\n        __consumers.splice(id, 1, nextAvailableConsumer);\n        setConsumers(__consumers);\n      });\n      const _consumers = [...consumers];\n      _consumers.splice(index, 1, nextAvailableConsumer);\n      setConsumers(_consumers);\n      setStreamData(_stream);\n    }\n  };\n\n  useEffect(\n    () => {\n      const processor = setInterval(() => {\n        processStream();\n        if (!streamData.length) clearInterval(processor);\n      }, 500);\n\n      return () => clearInterval(processor);\n    },\n    [streamData]\n  );\n\n  return (\n    <div className=\"stream-demo\">\n      <div className=\"producers\">\n        <button className=\"start-producing\" onClick={() => produce()}>\n          <i className=\"fas fa-reply\" />\n        </button>\n      </div>\n      <div className=\"storage\">\n        {streamData.map(data => (\n          <span key={data.id} className=\"data\">\n            {data.label}\n          </span>\n        ))}\n      </div>\n      <div className=\"consumers\">\n        {consumers.map((c, id) => (\n          <div key={id} className=\"consumer\">\n            <span className={c.isBusy ? \"name busy\" : \"name\"}>\n              {c.isBusy && <i className=\"fas fa-cog fa-spin\" />}\n              {!c.isBusy && <i className=\"fas fa-cog\" />}\n            </span>\n            {c.data && <span className=\"data\">{c.data.label}</span>}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n","import { createContext } from 'react';\n\n\n\nexport default createContext();\n","import React from \"react\";\n\nexport default ({ children }) => {\n  return (\n    <div>\n      {children}\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Route, Switch, withRouter, Redirect } from \"react-router-dom\";\n\nimport { Main, Layout } from \"./pages\";\n\nconst isLoggedIn = () => true;\n\nconst PrivateRoute = ({ component: Component, ...rest }) => {\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        isLoggedIn() ? (\n          <Layout>\n            <Component {...props} />\n          </Layout>\n        ) : (\n          <Redirect\n            to={{ pathname: \"/login\", state: { from: props.location } }}\n          />\n        )\n      }\n    />\n  );\n};\n\nconst Routes = () => {\n  const loginRedirect = () =>\n    isLoggedIn() ? (\n      <Redirect to=\"/\" />\n    ) : (\n      <Route path=\"/login\" title=\"Stream Demo\" component={Main} />\n    );\n  return (\n    <Switch>\n      <PrivateRoute exact path=\"/\" component={Main} />\n      <Route exact path=\"/\" render={loginRedirect} />\n      <Route exact path=\"/login\" render={loginRedirect} />\n      <Redirect to=\"/\" />\n    </Switch>\n  );\n};\n\nexport default withRouter(Routes);\n","import React, { useState } from 'react';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from 'history';\n\nimport StoreContext from './store';\nimport Routes from './Routes';\n\nexport const AppHistory = createBrowserHistory();\n\nexport default () => {\n\n\tconst [store, setContext] = useState({});\n\treturn (\n\t\t<StoreContext.Provider value={{store, setContext}}>\n\t\t\t<Router history={AppHistory}>\n        <Routes/>\n      </Router>\n\t\t</StoreContext.Provider>\n\t);\n}\n","import React from 'react';\nimport { render } from 'react-dom';\n\nimport './index.scss';\nimport App from './App';\n\nrender(<App />, document.getElementById('root'));\n"],"sourceRoot":""}